---
# EXECUTION-SPEC Frontmatter
# Generated by lead-architect skill
# Source: UI-SCAFFOLD-PROPOSITION.md (UI-SCAFFOLD-001 v1.3.0)

spec_id: EXEC-UI-SCAFFOLD-001
spec_title: "PT-2 Root Layout System & Navigation Scaffold"
source_doc: docs/ui-design/UI-SCAFFOLD-PROPOSITION.md
mvp_phase: 2  # Phase 2 - Session Management + UI (GATE-2)
priority: P0  # Blocking for PRD-006 Pit Dashboard

# Workstream Definitions
workstreams:
  WS1:
    name: Typography & Font System
    description: Replace Geist with JetBrains Mono + DM Sans via next/font
    agent: pt2-frontend-implementer
    depends_on: []
    outputs:
      - app/layout.tsx  # Modified - font imports
    gate: build-check
    estimated_complexity: low
    parallel_group: A

  WS2:
    name: Design Token Alignment
    description: Update globals.css with PT-2 design system tokens (sidebar, accent, backgrounds)
    agent: pt2-frontend-implementer
    depends_on: []
    outputs:
      - app/globals.css  # Modified - sidebar tokens, font families
    gate: build-check
    estimated_complexity: low
    parallel_group: A

  WS3:
    name: shadcn/ui Sidebar Installation
    description: Install sidebar component and dependencies via shadcn CLI
    agent: pt2-frontend-implementer
    depends_on: []
    outputs:
      - components/ui/sidebar.tsx
      - components/ui/tooltip.tsx  # dependency
      - components/ui/separator.tsx  # dependency
      - components/ui/sheet.tsx  # dependency (mobile)
    gate: build-check
    estimated_complexity: low
    parallel_group: A

  WS4:
    name: Route Group Structure
    description: Create (public) and (dashboard) route groups, migrate protected layout
    agent: pt2-frontend-implementer
    depends_on: [WS1, WS2]
    outputs:
      - app/(public)/layout.tsx
      - app/(public)/page.tsx
      - app/(public)/auth/  # moved from app/auth/
      - app/(dashboard)/layout.tsx
      - app/(dashboard)/page.tsx
    gate: build-check
    estimated_complexity: medium
    parallel_group: B

  WS5:
    name: App Sidebar Component
    description: Create PT-2 sidebar with navigation items per UI-SITEMAP.md
    agent: pt2-frontend-implementer
    depends_on: [WS3, WS4]
    outputs:
      - components/layout/app-sidebar.tsx
      - components/layout/nav-main.tsx
      - components/layout/nav-user.tsx
    gate: type-check
    estimated_complexity: medium
    parallel_group: C

  WS6:
    name: Header Component
    description: Create header with SidebarTrigger, breadcrumbs, gaming day indicator
    agent: pt2-frontend-implementer
    depends_on: [WS3, WS4]
    outputs:
      - components/layout/header.tsx
      - components/shared/logo.tsx
      - components/shared/gaming-day-indicator.tsx
    gate: type-check
    estimated_complexity: medium
    parallel_group: C

  WS7:
    name: Mobile Bottom Navigation
    description: Create bottom navigation for mobile viewport
    agent: pt2-frontend-implementer
    depends_on: [WS5]
    outputs:
      - components/layout/bottom-nav.tsx
    gate: type-check
    estimated_complexity: low
    parallel_group: D

  WS8:
    name: Dashboard Shell Integration
    description: Wire up SidebarProvider, AppSidebar, Header in dashboard layout
    agent: pt2-frontend-implementer
    depends_on: [WS5, WS6]
    outputs:
      - app/(dashboard)/layout.tsx  # Final integration
    gate: build-check
    estimated_complexity: medium
    parallel_group: D

  WS9:
    name: Stub Pages (Route Placeholders)
    description: Create placeholder pages for Phase 2 routes per UI-SITEMAP.md
    agent: pt2-frontend-implementer
    depends_on: [WS8]
    outputs:
      - app/(dashboard)/pit/page.tsx
      - app/(dashboard)/players/page.tsx
      - app/(dashboard)/settings/page.tsx
      - app/(dashboard)/settings/casino/page.tsx
      - app/(dashboard)/settings/staff/page.tsx
    gate: build-check
    estimated_complexity: low
    parallel_group: E

  WS10:
    name: Visual Validation
    description: Verify design system compliance, accessibility, responsive behavior
    agent: pt2-frontend-implementer
    depends_on: [WS8, WS9]
    outputs:
      - validation-report.md  # Optional
    gate: visual-check
    estimated_complexity: low
    parallel_group: F

# Execution Phases (topologically sorted, parallelized where possible)
execution_phases:
  - name: "Phase A - Foundation (Parallel)"
    description: "Independent setup tasks - can run simultaneously"
    parallel: [WS1, WS2, WS3]
    gates: [build-check]

  - name: "Phase B - Route Structure"
    description: "Create route groups with new layout structure"
    parallel: [WS4]
    gates: [build-check]

  - name: "Phase C - Layout Components (Parallel)"
    description: "Sidebar and header components - can run simultaneously"
    parallel: [WS5, WS6]
    gates: [type-check]

  - name: "Phase D - Integration (Parallel)"
    description: "Mobile nav and dashboard shell integration"
    parallel: [WS7, WS8]
    gates: [build-check]

  - name: "Phase E - Stub Pages"
    description: "Create placeholder pages for navigation targets"
    parallel: [WS9]
    gates: [build-check]

  - name: "Phase F - Validation"
    description: "Final visual and accessibility validation"
    parallel: [WS10]
    gates: [visual-check]

# Validation Gates
gates:
  build-check:
    command: npm run build
    success_criteria: "Exit code 0, no build errors"

  type-check:
    command: npm run type-check
    success_criteria: "Exit code 0, no TypeScript errors"

  lint:
    command: npm run lint -- components/layout/ components/shared/ app/
    success_criteria: "Exit code 0, no errors (warnings OK)"

  visual-check:
    command: "Manual verification"
    success_criteria: |
      - Dark theme is default (system preference respected)
      - Typography renders correctly (fonts load)
      - Sidebar expands/collapses correctly via SidebarTrigger
      - Sidebar collapses to icon-only mode
      - Collapsed sidebar shows tooltips on hover
      - Active nav item highlighted
      - Header renders with breadcrumbs
      - Mobile viewport: sidebar becomes off-canvas sheet
      - No console errors

# Agent Assignments
agent_assignments:
  pt2-frontend-implementer:
    workstreams: [WS1, WS2, WS3, WS4, WS5, WS6, WS7, WS8, WS9, WS10]
    capabilities:
      - React 19 + Next.js App Router
      - Tailwind v4 + shadcn/ui
      - PT-2 design system compliance
      - Accessibility (WCAG AA)

# External Dependencies
external_dependencies:
  - dependency: shadcn/ui sidebar component
    type: npm
    action: "npx shadcn@latest add sidebar"
    required_for: "WS3, WS5, WS6, WS8"

  - dependency: next/font/google
    type: builtin
    action: "No action - built into Next.js 16"
    required_for: "WS1"

  - dependency: lucide-react
    type: npm
    action: "Already installed (shadcn dependency)"
    required_for: "WS5, WS6, WS7"

# Risks and Mitigations
risks:
  - risk: "Route group migration may break existing protected routes"
    mitigation: "Create new route groups alongside existing, migrate incrementally"
    severity: medium

  - risk: "Font loading may affect LCP metrics"
    mitigation: "Use display: swap, preload fonts, verify with Lighthouse"
    severity: low

  - risk: "Sidebar state persistence may not work cross-page"
    mitigation: "shadcn sidebar uses cookie-based persistence by default"
    severity: low

---

# EXECUTION-SPEC: UI-SCAFFOLD-001 - PT-2 Root Layout System

## Overview

This execution spec transforms PT-2 from a generic Next.js starter template into a distinctive, professional casino pit management interface. It implements the foundational UI scaffold defined in `UI-SCAFFOLD-PROPOSITION.md`, establishing the typography system, design tokens, route structure, and navigation components required for PRD-006 Pit Dashboard and all subsequent UI work.

**Key Deliverables:**
- JetBrains Mono + DM Sans typography system
- Cyan/Teal accent design tokens
- shadcn/ui Sidebar with icon-collapse behavior
- `(public)` and `(dashboard)` route groups
- Header with breadcrumbs and gaming day indicator
- Mobile bottom navigation

## Scope

### In Scope
- Root layout typography configuration (JetBrains Mono, DM Sans)
- globals.css design token alignment (sidebar tokens, accent colors)
- shadcn/ui sidebar installation and configuration
- Route group structure: `(public)/` and `(dashboard)/`
- Dashboard shell layout with SidebarProvider
- App sidebar with PT-2 navigation items
- Header component with SidebarTrigger
- Mobile bottom navigation
- Stub pages for navigation targets

### Out of Scope
- Pit Dashboard UI implementation (PRD-006 - separate workstream)
- Player management pages (Phase 1 services)
- Loyalty/Compliance pages (Phase 3)
- Real-time features (WebSocket, Supabase Realtime)
- Authentication flow changes (existing auth preserved)
- API routes or service layer changes

## Architecture Context

### Source Documents
- `docs/ui-design/UI-SCAFFOLD-PROPOSITION.md` (v1.3.0) - Design decisions
- `docs/ui-design/UI-SITEMAP.md` (v1.0.0) - Route structure
- `docs/ui-design/pt2-ui-design-system-prototype-style-guide.md` - Design system

### Current State
| Element | Current | Target |
|---------|---------|--------|
| Typography | Geist Sans | JetBrains Mono + DM Sans |
| Layout | Flat protected layout | Route groups + dashboard shell |
| Navigation | Simple header nav | Collapsible sidebar + bottom nav |
| Theme | Light default | Dark-first with system preference |
| Branding | "Next.js Supabase Starter" | PT-2 Pit Station |

### Architectural Decisions
- **ADR-XXX**: shadcn/ui Sidebar over custom implementation (accessibility, maintenance)
- **ADR-XXX**: next/font over @fontsource (zero CLS, self-hosted, no external requests)
- **ADR-XXX**: Bottom navigation for mobile over sheet sidebar (pit floor usability)

---

## Workstream Details

### WS1: Typography & Font System

**Purpose**: Replace generic Geist font with distinctive PT-2 typography.

**Agent**: `pt2-frontend-implementer`

**Deliverables**:
1. Import JetBrains Mono (display, headers, data) via `next/font/google`
2. Import DM Sans (body, UI) via `next/font/google`
3. Configure CSS variables `--font-mono` and `--font-sans`
4. Apply font classes to HTML element

**Implementation**:
```tsx
// app/layout.tsx
import { JetBrains_Mono, DM_Sans } from 'next/font/google'

const jetbrainsMono = JetBrains_Mono({
  subsets: ['latin'],
  display: 'swap',
  variable: '--font-mono',
})

const dmSans = DM_Sans({
  subsets: ['latin'],
  display: 'swap',
  variable: '--font-sans',
})

// Apply: className={`${jetbrainsMono.variable} ${dmSans.variable} antialiased`}
```

**Acceptance Criteria**:
- [ ] JetBrains Mono loads for `.font-mono` utility
- [ ] DM Sans loads for `.font-sans` utility (default body)
- [ ] No CLS on font load (verify with Lighthouse)
- [ ] Fonts self-hosted (no Google requests at runtime)

---

### WS2: Design Token Alignment

**Purpose**: Update CSS variables to match PT-2 design system.

**Agent**: `pt2-frontend-implementer`

**Deliverables**:
1. Add sidebar-specific CSS variables
2. Update font-family tokens to use CSS variables
3. Add background-raised and accent-subtle tokens
4. Ensure dark theme is properly configured

**Implementation**:
```css
/* globals.css - Add to :root/.dark */
:root {
  --font-sans: var(--font-sans);
  --font-mono: var(--font-mono);
}

.dark {
  /* Sidebar tokens */
  --sidebar-background: 222 47% 6%;
  --sidebar-foreground: 210 40% 98%;
  --sidebar-primary: 189 94% 43%;
  --sidebar-primary-foreground: 210 40% 98%;
  --sidebar-accent: 189 94% 43%;
  --sidebar-accent-foreground: 210 40% 98%;
  --sidebar-border: 217 33% 17%;
  --sidebar-ring: 189 94% 43%;
}
```

**Acceptance Criteria**:
- [ ] Sidebar tokens defined for dark theme
- [ ] Font family tokens map to next/font CSS variables
- [ ] No visual regressions in existing components

---

### WS3: shadcn/ui Sidebar Installation

**Purpose**: Install production-ready sidebar component.

**Agent**: `pt2-frontend-implementer`

**Deliverables**:
1. Run `npx shadcn@latest add sidebar`
2. Verify sidebar.tsx installed in components/ui/
3. Verify dependencies (tooltip, separator, sheet) installed

**Command**:
```bash
npx shadcn@latest add sidebar
```

**Acceptance Criteria**:
- [ ] `components/ui/sidebar.tsx` exists
- [ ] All dependencies resolved
- [ ] No TypeScript errors from sidebar imports

---

### WS4: Route Group Structure

**Purpose**: Reorganize routes into public and dashboard groups.

**Agent**: `pt2-frontend-implementer`

**Deliverables**:
1. Create `app/(public)/` route group
2. Create `app/(dashboard)/` route group
3. Move auth routes under `(public)`
4. Create minimal layouts for each group
5. Preserve existing protected route functionality

**File Structure**:
```
app/
├── layout.tsx              # Root (fonts, providers)
├── (public)/
│   ├── layout.tsx          # Minimal public layout
│   ├── page.tsx            # Landing (redirects to /pit if auth)
│   └── auth/               # Moved from app/auth/
│       ├── login/
│       ├── sign-up/
│       └── ...
└── (dashboard)/
    ├── layout.tsx          # Dashboard shell
    └── page.tsx            # Redirects to /pit
```

**Acceptance Criteria**:
- [ ] Auth flows work unchanged
- [ ] Authenticated users see dashboard shell
- [ ] Unauthenticated users see public layout
- [ ] No broken links or 404s

---

### WS5: App Sidebar Component

**Purpose**: Create PT-2 sidebar with navigation items.

**Agent**: `pt2-frontend-implementer`

**Deliverables**:
1. `components/layout/app-sidebar.tsx` - Main sidebar component
2. `components/layout/nav-main.tsx` - Navigation items with active state
3. `components/layout/nav-user.tsx` - User menu in footer

**Navigation Items** (per UI-SITEMAP.md):
| Icon | Label | Route | Phase |
|------|-------|-------|-------|
| Table2 | Pit | /pit | 2 |
| Users | Players | /players | 1 |
| Gift | Loyalty | /loyalty | 3 (hidden) |
| Shield | Compliance | /compliance | 3 (hidden) |
| Settings | Settings | /settings | 1 |

**Acceptance Criteria**:
- [ ] Sidebar renders with `collapsible="icon"` prop
- [ ] Navigation items show icons and labels
- [ ] Active route highlighted via `isActive` prop
- [ ] Collapsed state shows tooltips on hover
- [ ] User menu in sidebar footer

---

### WS6: Header Component

**Purpose**: Create header with essential controls.

**Agent**: `pt2-frontend-implementer`

**Deliverables**:
1. `components/layout/header.tsx` - Header bar
2. `components/shared/logo.tsx` - PT-2 branding
3. `components/shared/gaming-day-indicator.tsx` - Gaming day context (TEMP-001)

**Header Contents**:
- SidebarTrigger (hamburger for collapse)
- Breadcrumb navigation (shadcn breadcrumb)
- Gaming day indicator (placeholder until CasinoService integration)
- User avatar (optional, duplicates sidebar footer)

**Acceptance Criteria**:
- [ ] SidebarTrigger toggles sidebar state
- [ ] Header fixed at top of content area
- [ ] Gaming day shows placeholder or actual date
- [ ] Responsive behavior (mobile-friendly)

---

### WS7: Mobile Bottom Navigation

**Purpose**: Thumb-friendly navigation for mobile pit floor use.

**Agent**: `pt2-frontend-implementer`

**Deliverables**:
1. `components/layout/bottom-nav.tsx` - Fixed bottom navigation

**Items** (max 4):
| Icon | Label | Route |
|------|-------|-------|
| Table2 | Pit | /pit |
| Users | Players | /players |
| Settings | Settings | /settings |

**Acceptance Criteria**:
- [ ] Only visible on mobile viewports (md:hidden)
- [ ] Fixed to bottom of viewport
- [ ] Active state matches current route
- [ ] Touch targets ≥44px

---

### WS8: Dashboard Shell Integration

**Purpose**: Wire up all layout components in dashboard layout.

**Agent**: `pt2-frontend-implementer`

**Deliverables**:
1. Final `app/(dashboard)/layout.tsx` with full integration

**Implementation**:
```tsx
// app/(dashboard)/layout.tsx
import { AppSidebar } from '@/components/layout/app-sidebar'
import { Header } from '@/components/layout/header'
import { BottomNav } from '@/components/layout/bottom-nav'
import { SidebarInset, SidebarProvider } from '@/components/ui/sidebar'

export default function DashboardLayout({ children }) {
  return (
    <SidebarProvider>
      <AppSidebar />
      <SidebarInset>
        <Header />
        <main className="flex-1 overflow-y-auto p-6">
          {children}
        </main>
      </SidebarInset>
      <BottomNav />
    </SidebarProvider>
  )
}
```

**Acceptance Criteria**:
- [ ] Sidebar state persists across pages (cookie)
- [ ] Content area scrolls independently
- [ ] Mobile: sidebar as off-canvas sheet
- [ ] Desktop: sidebar rail visible when collapsed

---

### WS9: Stub Pages (Route Placeholders)

**Purpose**: Create navigation targets to prevent 404s.

**Agent**: `pt2-frontend-implementer`

**Deliverables**:
1. `app/(dashboard)/pit/page.tsx` - "Pit Dashboard - Coming Soon"
2. `app/(dashboard)/players/page.tsx` - "Players - Coming Soon"
3. `app/(dashboard)/settings/page.tsx` - "Settings"
4. `app/(dashboard)/settings/casino/page.tsx` - "Casino Settings"
5. `app/(dashboard)/settings/staff/page.tsx` - "Staff Management"

**Template**:
```tsx
export default function Page() {
  return (
    <div className="space-y-4">
      <h1 className="text-2xl font-mono font-bold">Page Title</h1>
      <p className="text-muted-foreground">Implementation pending.</p>
    </div>
  )
}
```

**Acceptance Criteria**:
- [ ] All navigation items link to valid pages
- [ ] No 404 errors when clicking nav
- [ ] Pages show appropriate placeholder content

---

### WS10: Visual Validation

**Purpose**: Ensure implementation matches design system and accessibility requirements.

**Agent**: `pt2-frontend-implementer`

**Validation Checklist** (from UI-SCAFFOLD-PROPOSITION.md):
- [ ] Dark theme is default (system preference respected)
- [ ] Typography renders correctly (fonts load)
- [ ] Color contrast passes WCAG AA
- [ ] shadcn/ui sidebar expands/collapses correctly via SidebarTrigger
- [ ] Sidebar collapses to icon-only mode (collapsible="icon")
- [ ] Sidebar state persists across page refreshes (cookie-based)
- [ ] Collapsed sidebar shows tooltips on hover (tooltip prop)
- [ ] Active nav item highlighted via isActive prop
- [ ] SidebarRail allows hover-to-expand when collapsed
- [ ] Header renders with SidebarTrigger and breadcrumbs
- [ ] SidebarInset content area scrolls independently
- [ ] No console errors
- [ ] Mobile viewport: sidebar becomes off-canvas sheet
- [ ] Existing pages still render under new route groups

**Acceptance Criteria**:
- [ ] All checklist items verified
- [ ] No visual regressions from starter template

---

## Definition of Done

### Technical DoD
- [ ] All workstreams complete (WS1-WS10)
- [ ] All gates pass (build-check, type-check, visual-check)
- [ ] `npm run build` succeeds
- [ ] `npm run type-check` succeeds
- [ ] No ESLint errors in new/modified files

### Documentation DoD
- [ ] UI-SCAFFOLD-PROPOSITION.md status updated to ACCEPTED
- [ ] UI-SITEMAP.md implementation checklist updated
- [ ] Any new ADRs committed (if architectural decisions made)

### Quality DoD
- [ ] Dark theme default with system preference
- [ ] WCAG AA contrast compliance
- [ ] Mobile responsive (sidebar sheet + bottom nav)
- [ ] No console errors
- [ ] Fonts load without CLS

---

## Parallel Execution Strategy

```
Phase A (Foundation) - 3 parallel agents
├── [Agent 1] WS1: Typography System
├── [Agent 2] WS2: Design Tokens
└── [Agent 3] WS3: Sidebar Installation

Phase B (Route Structure) - 1 agent
└── [Agent 1] WS4: Route Groups

Phase C (Components) - 2 parallel agents
├── [Agent 1] WS5: App Sidebar
└── [Agent 2] WS6: Header

Phase D (Integration) - 2 parallel agents
├── [Agent 1] WS7: Mobile Bottom Nav
└── [Agent 2] WS8: Dashboard Shell

Phase E (Stub Pages) - 1 agent
└── [Agent 1] WS9: Stub Pages

Phase F (Validation) - 1 agent
└── [Agent 1] WS10: Visual Validation
```

**Maximum parallelism**: 3 agents in Phase A
**Total phases**: 6
**Critical path**: WS1/WS2 → WS4 → WS5/WS6 → WS8 → WS9 → WS10

---

## Related Documents

| Document | Purpose |
|----------|---------|
| `docs/ui-design/UI-SCAFFOLD-PROPOSITION.md` | Source proposition |
| `docs/ui-design/UI-SITEMAP.md` | Route structure |
| `docs/70-governance/FRONT_END_CANONICAL_STANDARD.md` | Technical standards |
| `.claude/skills/frontend-design/SKILL.md` | Implementation skill |
| [shadcn/ui Sidebar](https://ui.shadcn.com/docs/components/sidebar) | Component docs |

---

## Revision History

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0.0 | 2025-12-08 | Lead Architect | Initial EXECUTION-SPEC from UI-SCAFFOLD-001 |
