Architecture Analysis 2025-10-09 Architectural Recommendation time Solo developer 7/8 services (87.5%) zero features software 4 weeks 10 weeks

PT-2 6 weeks horizontal service layer (7 services 98 tests architectural over-engineering MVP need 7 services Player Visit business queries transforms Real infrastructure Optimistic updates mutations horizontal layering START vertical delivery 10 weeks first UI feature Recommended weeks saved faster Accept strategic technical debt post-MVP market validation weeks

MVP Core Feature Scope 1.1 Must-Have Features 1: Player Check casino floor manager check player track gameplay Player CRUD Visit start Rating Slip rating slip active play track performance award points Visit association Rating Slip close rating slips end play RatingSlip status transitions CTR Threshold compliance officer pending CTR reports>$10k transactions meet regulatory filing requirements MTL transaction logging threshold queries MVP Feature \*\*4 1.2 Deferred Features-MVP Advanced player search Table context management PlayerFinancial reports Real-time multi-user sync Optimistic UI updates Complex validation UI Audit trail UI Performance dashboards Time 4-6 weeks deferring 1.3 Minimum Viable Architecture services player index visit ratingsliplines player-financial NEEDED casino table-context mtl index (100 crud queries (100 7 services 1,400 lines code zero UI

\*\*Recommended services player.ts (200 visit.ts crud ratingslip.ts crud mtl.ts (300 lines index crud queries/actions player-actions.ts visit-actions server ratingslip-actions rating slip mtl-actions.ts (100 lines compliance actions use-player.ts React Query hooks-visit.ts-ratingslip.ts rating slip hooks-mtl.ts (100 lines compliance hooks players/page.tsx PlayerForm visits rating-slips compliance/page.tsx (CTRDashboard 4 services 4 pages MVP in 4

YAGNI Principle Architectural Patterns MVP Separate business modules Isolate complex workflows No workflows Visit lifecycle 3 methods 50 lines 2 days 7 days until workflow 200 Separate queries modules Organize complex queries needs list() getById() No JOIN queries MTL CTR 2 days 7 days until 5 complex queries Separate transforms modules Centralize DTO mapping DTOs Pick/Omit database (10 lines PlayerDTO 1 day 7 days until DTO logic exceeds 50 Separate validation modules schemas Validation server actions (20 lines playerCreateSchemaobject email lastName 5 lines 1 day service 7 days schemas 3 Real-time subscriptions scheduler Live multi-user sync Manual refresh MVP-user Casino floor managers work independently no collaborative editing 5 days 2 days domain days user feedback demands real Time Saved ship MVP 4 weeks 15

Explicit interfaces ReturnType Supabase client ServiceResult pattern error handling CRUD operations Player Visit RatingSlip MTL MTL queries CTR threshold detection 4 Server actions error handling ServiceResult revalidatePath cache No complex orchestration 3 React Query hooks create list staleTime 5 minutes custom caching 8 components forms list views pagination Loading states skeletons Error toasts Implementation (3 weeks 1 week buffer weeks

Time-to-Market Optimization Current Trajectory Layering 1-2 Complete Service Add business queries transforms days validationservices (3.5 days Perfect service layer zero UI 3-4 Action Layer Player Visit RatingSlip PlayerFinancial Casino TableContext MTL Complete action layer zero UI 5-7 UI Layer Player Visit RatingSlip PlayerFinancial Casino TableContext MTL Complete UI 7 services 8 Real-Time useSupabaseChannel wrapper Batch invalidation scheduler Domain real-time hooks (3 Real sync 9-10 Testing E2E tests (5 Performance optimization (3 Bug fixes (2 Production-ready MVP Time 10 user-visible feature Week (35 days Delivery 1: Player Management Feature Vertical createPlayerAction updatePlayerAction deletePlayerAction Integration testing polish (8 5 Buffer/documentation (8 hours Working Player CRUD UI

2: Visit Tracking startVisitAction StartVisitForm (8 EndVisitButton (6 VisitList (6 4: Integration testing polish (8 5 Buffer (8 Working Visit tracking UI-in/out 3: RatingSlip Management createRatingSlipAction RatingSlipEdit RatingSlipList (6 Integration testing polish (8 5 Buffer/documentation (8 hours Working RatingSlip UI tracking 4: MTL Compliance End-End createMTLEntryAction getPendingCTRsAction CTRDashboard End-to workflow testing Visit RatingSlip MTL (8 Production deployment prep (8 5 MVP demo stakeholder review (8 MVP 4 user-visible feature Week (5 days Saved 6 faster market Quick Wins Paths Consolidate Service 1 dayMerge index crud service Reduces overhead Inline 3 days Skip validation Zod schemas server actions playerCreateSchema Skip 3 days Use Pick<PlayerRow DTOs No extract transformation logic >50 lines Shadcn 5 days Pre-built Form Input Button Toast components No custom design Copy/paste

Win 5 Skip Real 5 days Add manual refresh not MVP Wins 17 days 4-week

Strategic Technical Debt Acceptance MVP Speed Service File service logic file >500 lines Reduces navigation overhead 500 lines 2 hours LOW refactor 2: Inline Validation Zod schemas server actions validationSaves 3 days abstraction Schema reused 3 operations 1 day extract schemas LOW Error String not domain catalogs Saves 3 days handling inconsistent>10 codes 2 days build error catalog MEDIUM Basic UI Real Manual refresh Saves 7 days real feedback requests updates 5 days add real-time hooks LOW No Optimistic Server mutations loading UI Saves 3 days state management complaints slowness 2 days add updates enhancement not 6 List Views Pagination Load records no pagination Saves 3 days pagination List queries exceed 100 records 1 day domain add pagination MEDIUM issue data grows

Debt Accepted 19 days future Time Saved 22 Benefit 3 days faster MVP deferred 4.2 Debt Baseline-Negotiable Service ReturnType Maintains type safety refactorability Cost 0 days Supabase Prevents safety erosion Cost 0 days \*\*ServiceResult consistent error handling contracts Essential UI error display Cost 0 days Test coverage Prevents regressions refactoring Cost 2 hours per feature Source Truth database schema Prevents type drift inconsistency Cost 0 days standards incremental protection rewrites

Future Evolution Hooks Preserve Refactoring Options Write code change not future case 1: Service Interface export interface PlayerService create getById update Future Evolution export interface PlayerService Existing methods create<ServiceResult getById update New methods added incrementally search<ServiceResult activate Add methods interface without changing signatures zero changes 2: Server Actions Thin export async function createPlayerAction await createClient await.create revalidatePath return result Future Evolution export async function createPlayerAction createClient playerService Add orchestration logic await playerService.createTrigger welcome email emailService.sendWelcome(result.data Log audit event auditService.log(\_created result.data revalidatePath(/players return result Actions start simple add orchestration workflows no complexity 3: React Query Hooks Abstraction export function useCreatePlayer(.success created Future Evolution Optimistic Updates export function useCreatePlayer( async Optimistic update queryClient.cancelQueries('players.getQueryData.setQueryData Rollback error.setQueryData.invalidateQueries'Player created \*\*Evolution start simple add optimistic updates UI layer isolated change

4: UI Components Receive Props Services export function PlayerForm( useCreatePlayer Future Evolution Real-Time export PlayerForm( Add real hook Subscribes player changes Components use hooks real-time opt-in enhancement no rewrites Refactoring Trigger Conditions 1: Service File Exceeds 500 Split business queries modules 2 hours Zero changes Validation Schema Shared 3 Extract validation.ts 1 hour DRY violation resolved DTO Transformation Logic Exceeds 50 Extract transformstoDTO 1 hour Improved testability Error Handling>10 Create domain error catalog 2 hours Consistent error Feedback useSupabaseChannel hooks 5 hours Progressive enhancement List Views 100 Add pagination scroll 4 hours Performance improvement Team Size 3 Formalize contracts ESLint rules 2 days Team coordination Deferred hours 2 days post

Solo Developer Optimization 6.1 Context Switching Minimization-Pattern** (Horizontal Monday services Tuesday actions Wednesday hooks Thursday UI 4 context switches day no completion **Recommended Week 1: Work Player domain Monday Tuesday Wednesday Thursday Testing polish Friday Demo stakeholders Week 2: Work Visit 3: RatingSlip 4: MTL 1 context (domain per week daily progress weekly completion 6.2 Cognitive Load Reduction Cognitive Small services/player index crud 2 business 3 queries 4 transforms 5 validation 6 create() logic?" 6 files search **Low Cognitive Load** services/playerlines logic create( file Cmd finds code pain exceeds benefit>500 lines Fast Iteration Cycle

Write PlayerService tests (30 fix bugs Commit service layer (5 WAIT services complete createPlayerAction( (15 tests (20 useCreatePlayer() hook (10 tests hook (20 PlayerForm (30 Test browser fix bugs (30 RESULT AFTER 3+ WEEKS 3 weeks Write PlayerServicecreate() method (15 min createPlayerAction() useCreatePlayer() hook (10 PlayerForm component (30 Test browser (10 Fix bugs (30 tests full slice (1 hour USER RESULT AFTER 3 HOURS 3 hours 56x faster feedback loop issues 6.4 Motivation Progress Tracking Week 1: layer 85% 2: 100% 3: 50% 4: 100% 5 UI rendering Low (5 weeks code Week 1: Management COMPLETE 2: Tracking 3: Management 4: DEPLOYED High wins stakeholder feedback market validation developers need Horizontal layering demotivating

Good Perfect 7.1 Perfect Architecture (10 Weeks) 4 layers Service Action UI strict boundaries 5 modules per service ESLint rules layer isolation error catalog Real-time batch invalidation UI updates scroll Advanced search filters E2E Playwright tests Lighthouse performance budgets documentation ADRs Onboarding guide 10-12 weeks Week 10 Market validation 10 weeks ship Good Enough Architecture (4 Weeks 3 layers Action UI manual discipline 1 file per service >500 lines Code review coupling String error messages Manual refresh real Server mutations pagination >100 records Basic search filters Manual testing MVP Basic Lighthouse checks CI enforcement README patterns ADRs Code comments onboarding 4 weeks Week 1 Technical debt 2 weeks post TradeDecision

Aspect Perfect Decision Rationale ESLint rules Manual review Solo dev violate rules 5 files/service 1 file >500 lines Services <200 lines catalog String messages add codes-Time WebSocket subscriptions Manual refresh Single-user workflow no collaboration Optimistic updates Loading spinners performance acceptable Pagination scroll Load records <100 records Advanced filters Basic name search lookup E2E Playwright 90% integration 80% catches regressions ADRs guides READMEs comments Solo dev knows context Explicit interfaces Prevents rewrites database.typessingle source automated zero cost 9/11 Enough weeks time 2 quality gates Strategic Debt Paydown Plan-MVP Architecture Extract validation reused 3 Extract transforms logic >50 lines error catalog >10 codes Add pagination 100 records Write ADRs key decisions (8

MVP+2 Performance 1-2 Playwright E2E tests (16 Lighthouse optimization real-time hooks 5 Documentation cleanup refinement (8 Debt 2 weeks 4 weeks MVP 2 weeks refinement weeks 10 weeks 40%

Steps Implementation 8.1 Actions Week business modules queries transforms validation Planning infrastructure Researching update patterns Designing error catalogs Pick feature "Create Player Build vertical slice 1 day createPlayerAction useCreatePlayer( PlayerForm (4 Test browser (2 hours Demo stakeholder 4-Week MVP Roadmap 1: Player Management 8:00-10:00 Create app createPlayerAction revalidatePath 10:00-12:00 useCreatePlayer() 13:00-17:00 app-form 17:00-18:00 Test browser fix bugs create player UI 8:00-10:00 updatePlayerAction() useUpdatePlayer( 10:00-12:00 Create components-edit13:00-15:00 deletePlayerAction 15:00-17:00 Update player-form edit 17:00-18:00 Test CRUD fix bugs CRUD 8:00-10:00 Edit 10:00-12:00 search 13:00-15:00 Polish UI error 15:00-17:00 player-actions 17:00-18:00 use-player Player Management UI

8:00-12:00 Integration testing 13:00-15:00 Fix bugs 15:00-17:00 Polish responsive design 17:00-18:00 Update documentation Player feature demo 8:00-10:00 Stakeholder demo feedback 10:00-12:00 critical feedback 13:00-17:00 Buffer issues 17:00-18:00 Plan next week 1 2: Visit Tracking 8:00-10:00 app startVisitAction casinoId no 10:00-12:00 13:00-17:00 app-visit-form Player Casino Start Visit 17:00-18:00 Test visit start fix bugs start visit UI 8:00-10:00 endVisitAction( 10:00-12:00 cancelVisitAction( 13:00-15:00 components-detailvisit info casino End buttons 15:00-17:00 Test lifecycle 17:00-18:00 Fix bugs lifecycle 8:00-10:00 player casino start time status 10:00-12:00 Add status badges 13:00-15:00 Polish UI error 15:00-17:00 visit-actions 17:00-18:00-visit Tracking UI

8:00-12:00 Integration testing 13:00-15:00 Fix bugs 15:00-17:00 Polish 17:00-18:00 Update documentation demo 10 8:00-10:00 Stakeholder demo feedback 10:00-12:00 Address feedback 13:00-17:00 Buffer Plan next week 2 3: RatingSlip Management 11 8:00-10:00 Create 10:00-12:00 Create 13:00-17:00 Visit Table Average Bet Start Points calculation 17:00-18:00 Test rating slip creation UI 12 8:00-10:00 updateRatingSlipAction 10:00-12:00 closeRatingSlipAction ACTIVE CLOSED 13:00-15:00 Update ratingslip-form Close RatingSlip button Test update workflows RatingSlip lifecycle 13 8:00-10:00 CreateFilter visit status player table bet points 10:00-12:00 points 13:00-15:00 Polish UI ratingslip RatingSlip UI 14 8:00-12:00 Integration testing Visit RatingSlip Fix 15:00-17:00 Update RatingSlip demo 15 8:00-10:00 Stakeholder demo feedback 10:00-12:00 Address feedback 13:00-17:00 Buffer Plan final week 3

4: MTL Compliance MVP 16 8:00-10:00 createMTLEntryAction amount direction Validation 10:00-12:00 usePendingCTRs$10k 13:00-17:00-form Patron Amount Direction Gaming day calculation 17:00-18:00 Test MTL MTL transaction UI 17 8:00-10:00 getPendingCTRsAction usePendingCTRs-dashboard CTR reports patron amount transaction count$10k threshold violations Test CTR threshold detection Fix bugs CTR compliance dashboard 18 8:00-12:00 End-to workflow testing Player check-in MTL log Verify data Fix integration bugs 17:00-18:00 testing workflow operational 19 8:00-10:00 Production deploymentDatabase migrations Type regeneration 10:00-12:00 Deploy production 13:00-15:00 testing Fix issues 17:00-18:00 Monitoring MVP deployed 20 8:00-10:00 demo 10:00-12:00 Collect feedback 13:00-15:00 post-MVP backlog 15:00-17:00 Document technical debt 17:00-18:00 Celebrate MVP launch COMPLETE Tools Libraries Copy Tailwind CSS Pre-built Form Input Button Select

react-hook-form Minimal boilerplate validation Uncontrolled inputs performance Zod Schema-based TypeScript schemas React Query Default 5 no caching invalidation No MVP toast No configuration Supabase RLS policies Real-time Type generation React Testing Unit tests Integration tests Component tests E2E Playwright Vercel Zero-config Next.js deployment Environment variables dashboard Preview deployments

Success Metrics Acceptance Criteria 9.1 Week 1 (Player Management create player view players edit details delete search players name PlayerService.create/update Server actions return ServiceResult React Query hooks cache Loading states mutations Error toasts failures Form validation prevents invalid submissions 80%+ test coverage player-actions No console errors Responsive design Zero TypeScript errors ESLint errors Floor manager creating players Feedback next iteration 9.2 Week 2 Success Criteria (Visit Tracking start visit view active visits end cancel view historical visits VisitService lifecycle Visit status transitions validated Player/Casino associations correct keys Cache invalidation works 80%+ test coverage visit-actions.Integration Player No console errors design Floor manager check workflow tracking needs 9.3 Week 3 Success Criteria Management

create rating slip bet update details close points view slips visit Points calculation RatingSlipService lifecycle functional Visit association validated ACTIVE visit Points calculation correct bet time rate Status transitions → CLOSED 80%+ test coverage ratingslip-actionsIntegration Player Visit RatingSlip No console errors rating slip Points calculation Week 4 Success Criteria Launch log MTL transaction view CTR reports>$10k Player Visit RatingSlip MTL 4 features integrated MTLService queries Production database migrations Environment variables Production deployment tests No production errors 4 features demonstrable User feedback collected Compliance officer CTR monitoring Floor manager workflow MVP approved Post-MVP Metrics 5+) 5+ active users 20+ players created 50+ visits 30+ rating slips tracked 10+ MTL entries

<1% error <500ms response Zero outages <5 bugs User satisfaction >7/10 3 feature requests Technical debt backlog

Risk Mitigation Rollback Plan Risk Assessment Likelihood Impact Severity Mitigation slice 1 Time 5 days cut scopeskip search actions performance Load testing Day 3 optimize queries Query cache invalidation refresh test invalidation features mid post-MVP backlog 4-week timeline deployment rollback plan debt 2-week debt paydown post-MVP developer Buffer days no weekend work Rollback Strategies Vertical Slice Week 1 Cut scope minimal CRUD functionality Add features Week 5 Action Layer Performance Server actions >1s response Add database indexes optimize queries connection pooling 1 day delay domain optimization sprint post-MVP React Query Integration Cache invalidation stale data SWR library management 2 days rework technical debt fix post-MVP Stakeholder Rejects MVP more features before launchNegotiate scope remove week delay-prioritize backlog 5-week timeline

Deployment Migration fails Rollback fix staging 1-2 days downtime Test migrations staging deployment checklist

Comparison Documentation 11.1 HORIZONTAL_LAYERING_ANALYSIS.md 4-layer architecture Service Action UI sound Bottom-up sequencing layer correct service interfaces prevent coupling ServiceResult pattern error handling-engineers module (5 files per service <200 services user (10 weeks UI feature team rules solo dev abstraction** validation before NOT immediate implementation path 11.2 VERTICAL_SLICING_PHILOSOPHY.md Feature-complete delivery (Database UI single Cognitive locality Incremental refactorability Reduced regression scope CRUD slices clear service directories team devs Use **delivery cadence\*\* NOT directory structure 11.3 RISK_AND_MIGRATION_ANALYSIS.Critique Hybrid model vertical pragmatic Acknowledges solo developer Incremental risk Rollback strategies phase completes horizontal service layer 1-2 modules UI Week Day 1 weeks 4 weeks vertical delivery accelerate timeline vertical delivery Document Differentiation

(4 domains not 7) days saved skipping abstractions developer switching cognitive load motivation 8-10 technical debt payable quantified-by implementation trade-off Perfect working software 4 weeks not 10 weeks Accept strategic debt pay post-MVP market

Recommendation Horizontal layering service modules before UI Vertical delivery horizontal Action Hook UI Deliver vertical Visit 2 Consolidate services single file >500 lines validation>3 uses Skip real-time updates MVP Week Player Management Visit Tracking 3: RatingSlip Management 4: MTL Compliance MVP integration production Maintain service interfaces typed dependencies 80% test coverage Accept strategic technical debt Action approve analysis Commit 4-week MVP timeline Cancel horizontal layering Create app hooks-player Start components-form(4 hours Finish PlayerForm Test player Fix bugs polish UI Add update actions hooks Create PlayerList Buffer Demo Collect feedback 1 12.3 Success Criteria MVP Player Management Visit Tracking RatingSlip MTL Compliance Deployed production User feedback Quality service interfaces Typed dependencies 80%+ test coverage Zero security issues ServiceResult pattern Debt backlog Paydown plan weeks Trigger conditions Refactoring estimated

5+ users satisfaction >7/10 3 feature requests-go development

Appendix A Viable Smallest feature set user value market validation premature optimization abstraction necessary code technical responsibility features end-to-end layers Horizontal layers vertical delivery Shortcuts speed future paydown time-to optimization Enough Minimal value quality Business logic database operations Server-side orchestration cache management React Query wrappers state management Components presentation logic

Appendix B/CANONICAL_BLUEPRINT_MVP_PRD_LAYER_ARCHITECTURE_DIAGRAM_RESPONSIBILITY_MATRIX_STEPS_REPORT_LAYERING_ANALYSIS_MIGRATION_ANALYSIS_SLICING_PHILOSOPHY Next App Router Documentation routes horizontal structure React Query Best Practices caching invalidation Shadcn/UI Component Library Supabase RLS Policies 1.0.0 System Architect 2025-10-09 Final Recommendation End Week 1 vertical slice delivery
