PT-2 Consensus Synthesis 2025-10-09 Consensus Recommendation 5 Path D Hybrid Model Vertical

Five architects analyzed PT-2's strategy Layering Technical structure-Driven Vertical context boundaries Strategy Complementary dimensions Migration Pragmatic path assessment-Pragmatic Time-market optimization Model (Path D layers vertical slices weeks production 12 weeks vertical 10 weeks horizontal zero rework alternatives

Areas Consensus False Dichotomy Identified 5 architects vs Horizontal NOT either/or Hybrid tension slicing layering PT-2 needs BOTH Risk horizontal service layer problem build MVP horizontal Action Deliver vertical week 1 2Architecture horizontal structure delivery vertical cadence Foundation Strong 5 architects 7 services 98 tests >80% coverage Explicit interfaces inference Typed dependencies Functional factories class services context integrity 4x template velocity Zero PRD violations Risk services 2 days rework days lost vertical restructure restructure services Implementation Sequence architects bottom-up vertical delivery Service Layer Completion MTL queries search modules Integration testing Vertical Slices Player Management Visit Tracking RatingSlip Creation Real-Time Infrastructure Horizontal enhancement Domain hooks Production Hardening Integration testing Performance optimization Deployment 8 weeks production-ready MVP Anti-Patterns-to-Service orchestration Real-Time Domain-specific hooks cleanup prevent coupling Zero violations standard

Type safety non Zero violations maintain standard-Based factories 100% compliance quality gates compromised

Productive Tension 2.1 Module Granularity 5 modules 1 file service >500 lines services <200 lines consolidated files split 500 lines modules 3 operations YAGNI principle trumps abstraction solo developer Real-Time Priority Phase 5 enhancement Post-core features Horizontal infrastructure refresh Week 6-7 Deferred UI complete 7 enhancement MVP Real-time NOT launch-critical Time First UI Feature Week 5 Week 2-3 vertical delivery 2-3 solo testing First UI 2-3 weeks NOT 5

Recommendation Path D Model 3.1 Architecture Structure UI Layer Components Hooks State Server Actions ACTION Layer Orchestration Cache Service Factories SERVICE Layer CRUD Business Queries Client DATA Layer Schema RLS Triggers Separation concerns testability clear boundaries Player Management Data player table RLS.create Action useCreatePlayer( UI PlayerForm COMPLETE Week 2-3 Visit Tracking visit table lifecyclestartVisit VisitForm Week 4-5 User value stakeholder demos incremental delivery 3.2 Implementation Timeline 1: Service Layer MTL queries Add business modules Integration testing Phase 2 audit 2-3 Player Management create update delete Working UI 4-5 Visit Tracking start end cancel UI 6 RatingSlip Creation create update close UI 7 Real-Time Infrastructure wrapper Batch invalidation scheduler Domain real-time hooks Memory leak prevention synchronization 8 Production Cross-domain integration tests Bundle optimization Lighthouse CI ≤2.5s TBT ≤200ms JS ≤250KB Deployment automation Production MVP 3.3 Core Domain Boundary

executeOperation ServiceResult error/supabase Client factories server/database Canonical schema/ui presentational primitives/shared useSupabaseChannel batch invalidation domains modification/<domain Business logic DTOs validation/actions Server actions orchestration React Query real subscriptions<domain-specific UI tests business rules context Horizontal Layer Enhancement infrastructure Standardizing cross-cutting system evolution Testing infrastructure Vertical Feature Delivery user-facing functionality Domain-specific business logic MVP prioritization Stakeholder demos 1 domain VERTICAL domains HORIZONTAL user-facing VERTICAL HORIZONTAL

Rejected Alternatives 4.1 Path B Vertical Slicing Directories HIGH 12 weeks LOW weeks lost Restructuring 7 services reimplements patterns service Loss PlayerService contract tests migrate velocity 4x improvement pain point Services <200 lines services large optimization Service files exceed 500 lines 5 modules service Team size >3 developers Feature independence validated 4.2 Path C Strict Horizontal Layers Structure MEDIUM 10 weeks MEDIUM Solo developer experiment More files 10-person team solo Week 5 Week 2-3 layer boundaries Clean boilerplate solo dev Team size >3 developers Onboarding Layer violations Technical debt

Strategic Technical Debt Speed architects debts 1: Consolidated Service 1 file >500 lines 500 lines 2 hours Inline schemas server not validation reused 3 operations 1 day extract Simple Error String messages not error catalogs >10 error codes 2 days catalog MEDIUM 4: Manual No real-time 5 days LOW 5 No Optimistic Server mutations loading complaints 2 days domain 6 Basic Lists Load records 100 records 1 day domain MEDIUM Deferred ~19 days Time ~22 days days faster deferred 5.2 Non Quality Gates architects Service No ReturnType inference Supabase Consistent error handling Test Source Zero incremental cost high protection value

Success Metrics Phase 2 7/7 services 110 tests >80% coverage Zero PRD violations Phase 3 2-6) 3 slices UI E2E <500ms React Query cache >70% Phase 4 7) <1s Zero memory leaks Multi-tab sync Clean subscription lifecycle Production Ready 8) LCP TBT JS Zero warnings Deployment automated Health checks

Governance Enforcement Coupling Prevention-to-Service BANNED Code architecture tests Boundary ZERO team size >3 BANNED Functional factories 100% compliance Safety ZERO TypeScript Zero violations Adaptation Triggers Service File >500 lines modules Split modules 2 hours Team >3 developers Formalize layer contracts 2 days Cross-Domain >3 services workflow orchestration 1 week Performance Actions >500ms >3s tuning 3 days Testing >10min >20% time Re-balance pyramid integration 1 week

Rollback Strategies Layer Performance cache bugs Revert Server Components 2 days stabilize Commit layers Layer React Query SWR 3 days migrate Wrap Query hooks-Time Memory leaks Disable subscriptions polling 1 day enhancement Path flaw Service layer tests redesign 5 days redesign Service layer independence

Horizontal Layering Technical 4-layer architecture sequencing Cross-layer communication Testing pyramid Adopt defer growth Domain-Driven Vertical Architect isolation 5 vertical slices Sequencing dependency Anti-corruption Integration contracts Domain-level Action orchestration Hybrid Strategy Architect Complementary dimensions balance dichotomy Core Domain boundary folder structure enforcement Horizontal vertical delivery-week Risk Migration Architect Risk assessment migration rollback plans cost Adaptation triggers Decision tree lowest risk highest ROI MVP-Pragmatic Architect Time-to-market developer YAGNI audit debt acceptance developer 4-week roadmap delivery defer abstractions

Consensus D Hybrid layers vertical weeks production 4 horizontal layers Service Action UI 3 vertical slices Real infrastructure 7) Integration performance 8) Explicit interfaces Typed dependencies 80% test coverage ServiceResult pattern Zero layer violations Consolidated files >500 lines Inline validation 3+ reuses Manual refresh real-time MVP pagination >100 records Paydown 2 weeks post-MVP (8 weeks 12 vertical 10 weeks horizontal 5

Steps Complete MTL Service queries Add business modules Integration testing Phase 2 audit Document Create ADR-003 Hybrid Slicing Model Start Player Management slice Implement createPlayerAction() hooks UI tests Demo Collect feedback weeks production First 5 Second 6 Third 7 Real-time 8 Production deployed

Appendix A Architect Vote Summary Aspect Horizontal Vertical Hybrid Risk MVP Consensus **Architecture Path C Path B Path D to MVP** 10 12 weeks 8 weeks weeks Granularity** 5 files Domain-level Defer split Start consolidated 1 file-Time Priority** Week 7 Post-MVP UI Week 5 Week 3 2-3 Restructure\*\* \*\*Risk MEDIUM HIGH LOW MEDIUM HIGHEST architect optimized speed (4 weeks Day 1 UI consensus adjusted solo developer pace testing architects recommend Path D (Hybrid Model

Appendix B Related Documentation Analysis [Horizontal Layering Analysis-Driven Vertical Analysis Strategy Analysis Migration Analysis-Pragmatic Analysis [Canonical Blueprint PRD Layer Architecture Matrix [Session Handoff 1.0.0 2025-10-09 Consensus Reached Approved Implementation End Phase 3 (Week 5) (unanimous recommendation CONSENSUS SYNTHESIS\*\*
