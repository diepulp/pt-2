Loyalty Service Convert gameplay telemetry player rewards points logic tier progression preference management Accrual Compute points RatingSlip telemetry Record points transactions Management player tier thresholds progress reward communication preferences index ledger player_loyalty business Points calculation queries getBalance telemetry-mapper RatingSlip data Loyalty accruePointsFromSlip playerId averageBet durationMinutes gameType getBalance getTransactionHistory calculatePoints averageBet multiplier Analytics Gameplay metrics RatingSlip Reward policy logic Loyalty Player identity scaffold services/loyalty implement CRUD calculation pipeline integrate event listener ratingSlipService
