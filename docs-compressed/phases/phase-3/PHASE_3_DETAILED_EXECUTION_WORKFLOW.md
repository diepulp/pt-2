Phase 3-Agent Delegation Parallel Weeks 3-6 Wave parallelization Time 15 hours (26%

Executive Summary Time Analysis 3 12 hours 18 4-6 17 hours 20 savings Phase 63 hours 78 hours Parallelization Strategy 1 4 tasks 2 Query Mutation Intelligent agent selection specialized MCP servers Validation checkpoints

Week 3: HORIZONTAL Foundation shared state management infrastructure Weeks 4-6 vertical feature delivery 12 hours 18 sequential 6 hours (33% Wave 1: Parallel Infrastructure Setup (4 hours tasks concurrently dependencies Task 1.1 React Query Setup Full-Stack Developer 4 hours Critical Wave 2) None/query-client.ts React Query configuration/layout.tsx QueryClientProvider integration DevTools setup React Query Query library v5 setup Next.js App Router TypeScript Configuration provider setup DevTools integration Query Client/query-client.ts QueryClient Provider Root/layout Add QueryClientProvider wrapper Client-side rendering directive React Query/layoutAdd<ReactQueryDevtools development mode Dependencies-query-devtools package.json updated run dev console errors DevTools accessible query validate React Query renders DevTools:3000 queryClient TypeScript compilation successful Tool Context7 Read Write Edit Bash Task 1.2 Server Action Wrapper Backend Architect 3 hours High None/actions-action-wrapper.ts Standardized wrapper Error mapping DB errors Audit logging integration-Step

Error MCP error handling Review 7 Phase 2 services Extract Common error types violations validation NOT_FOUND Wrapper MCP analysis Async function wrapper Result<T User context action name error handling Wrapper Tool File/actions-action-wrapper.ts import Result export async function<T Promise<Result userId metadata Record Promise<Result await action Audit logging production audit_log table result Error mapping.code success false error_KEY_VIOLATION_VIOLATION_ERROR Error error mapping PostgreSQL error codes (23XXX DB errors user messages Audit audit_log Implement logging production userId action timestamp metadata Sample Player execute_sql test queries CRUD operations wrapper Verify Error mapping Wrapper tested â‰¥1 service Error mapping covers FK unique validation errors Audit logs audit_log table TypeScript types correct Tool Read Write Edit Supabase Task 1.3 UI Stores Full-Stack Developer 2 hours Medium None Global UI state-store Player-specific UI state Documentation state boundaries

Zustand Best Tool MCP resolve Zustand library Query best practices Next.js TypeScript Extract Store creation patterns TypeScript types selectors Global UI Tool `Write File/ui-store.ts Content import create interface UIStore Modal boolean null unknown Navigation sidebarOpen boolean Actions openModal UIStore data unknown closeModal toggleSidebar useUIStore create modalType null modalData sidebarOpen true openModal closeModal toggleSidebar sidebarOpen Player UI Tool `Write File/player-storeContent import create interface PlayerStore Filter state UI searchQuery string statusFilter 'all 'inactive sortBy 'name 'createdAt 'lastVisit Actions setSearchQuery setStatusFilter setSortBy resetFilters export usePlayerStore create searchQuery statusFilter sortBy setSearchQuery setStatusFilter setSortBy resetFilters statusFilter sortBy State Tool File/README.md Content Zustand Store Guidelines Ephemeral UI State Modal open/close state Navigation state UI filters sort pagination Form state-step forms Server data visits rating slips Fetched data Persistent state database User session Next.js auth React Query owns server state

Verify package.json Store Create test component Modal open/close sidebar toggle State updates UI stores handle modal navigation filter state No server data Stores TypeScript interfaces README.md Tool Context7 Write Bash Task 1.4 ADR-003 Draft System Architect 1 hour Medium None Wave 4)/adr/ADR-003-state-management-strategy.md ADR-003-state-management-strategyTitle Status Context Decision Consequences React Query defaults Query key pattern Invalidation strategy Zustand scope UI Status Finalize after Week 3 ADR-003 draft Key decision areas DRAFT finalization Tool Wave 1 Completion Criteria tasks (4 hours React Query provider Server action wrapper 3h Zustand stores 2h ADR-003 draft 1h React Query setup Hook Templates (3 hours Sequential completion Task 2.1 Service Query Hook Template TypeScript Pro 1.5 hours Critical Weeks 4-6 React Query setup-query Result React Query mapping Result Phase 2 service implementations Success/error structure data types

React Query TypeScript Tool `Context7 MCP React Query documentation generic types error handling Type-safe hook patterns Service Query Tool `Write File/shared-service-query.ts Content import useQuery/react-query Result/types/result useServiceQuery queryKey string queryFn Omit return useQuery async result queryFn Error result.data Query Key Tool `Write File/shared/README.md Document[domain entity id pattern Examples all players single player searchQuery results Example Tool `Edit `hooks/shared/READMEexample player useServiceQuery getPlayerAction Template handles Result React Query mapping TypeScript generics Query key pattern Tool Sequential Context7 Read Write Edit Task 2.2 Create Service Mutation Hook Template TypeScript Pro 1.5 hours Critical Weeks 4-6 React Query setup Cache invalidation pattern React Query Mutation TypeScript cache invalidation Extract Mutation patterns callbacks invalidation Service Mutation-mutationContent import useMutation useQueryClient/react-query Result/types/result useServiceMutation<TData TVariables mutationFn Promise<Result Omit<UseMutationOptions<TData Error TVariables queryClient useMutation mutationFn async TVariables result mutationFn Error return result

Invalidation.md Add Cache Invalidation `queryClient.invalidateQueries createPlayer useServiceMutation queryClient.invalidateQueries Optimistic Update.md Optimistic update pattern `onMutate rollback pattern Template handles Result mutations Cache invalidation pattern TypeScript generics variables data Tool Write Edit Wave 2 Completion Criteria Hook templates Documentation Query key pattern Cache invalidation strategy infrastructure components Wave Integration Smoke Tests (4 hours Sequential Task 3.1 Create Integration Test Suite Full-Stack Developer 4 hours Critical Week 3 success React Query setup Server action wrapper Hook templates 7 Phase 2 services.test Cross-service workflow validation Service/player-slip-context/mtl Extract CRUD operations per service Test Suite/integration/services-smoke.test Test database Supabase client cleanup Individual Service Basic CRUD 7 services Verify Create read update delete operations Assert Result success/error handling Cross-Service Workflow Complete workflow services Create Casino Player Visit RatingSlip Verify Referential integrity Assert FK relationships

Error FK violation entity Unique data NOT_FOUND ID Server action wrapper error mapping Test output pass/fail Debug failures Supabase MCP queries-3/integration-test-results failures Items blocking Week 4 7 services pass tests Cross-service workflow Error handling No critical issues 4 Tool Wave 3 Completion Criteria Integration tests Cross-service dependencies Error handling Issues documented Testing complete patterns validated Finalize ADR-003 (1 hour Sequential Task Finalize State Management ADR System Architect 1 hour High React Query tested Hook templates validated Patterns proven integration tests-003-state-management-strategy-by-Step Implementation Week 3 implementations Integration test results worked lessons learned-003-state-management-strategy.md Update React Query defaults values Query key pattern Invalidation strategy Confirm Zustand UI code examples Hook template Cache invalidation patterns Error handling examples Change status DRAFT ACCEPTED Add Acceptance date decision rationale alternatives considered

add docs-003-management-strategy ADR-003 strategy ADR-003 ACCEPTED decisions Examples Committed repository Tool Read Edit Bash Wave 4 Completion Criteria ADR-003 finalized accepted State management decisions Ready Weeks 4-6 development

Week 3 12 hours 18 6 hours (33% React Query Server action wrapper Zustand stores Hook templates Integration tests ADR-003 Weeks infrastructure vertical delivery

Weeks 4-6 VERTICAL Feature Development feature Visit pattern Time 17 hours 20 sequential 3 hours (15%) Weeks 51 hours 60 hours Development 4: Player Management 5 Visit Tracking 6 RatingSlip Creation execution pattern Wave 1: Server Actions (4 hours Sequential Task 1.1 Implement Server Actions Backend Architect 4 hours Critical waves Phase 2 service layer Server action wrapper 3)/actions/{domain-actions.ts CRUD operations Service methods delete Input error Server ActionsAdd server directive top Create Add createEntityAction server import withServerAction/actions createClient/supabase/server EntityService/services{domain export async function createEntityAction return withServerAction supabase createClient service EntityService service.createEntity userId Read Add getEntityAction listEntitiesAction Include Pagination parameters Search functionality Update Add updateEntityAction Partial updates Delete Add deleteEntityAction Soft delete Each `Supabase MCP execute_sql test data setup Create test script Next API Verify action Error handling wrapper

Error FK violation Unique constraint violation NOT_FOUND Correct error messages CRUD operations functional Server action wrapper Error handling TypeScript compilation successful Tool Read Write Edit Supabase Bash Wave 1 Completion Server actions Error handling Ready hook development Wave Server actions complete Wave 2: Query Mutation Hooks (3 hours Parallel Wave Task 2.1 Create Query Hooks TypeScript Pro 3 hours Critical Server actions Hook templates Single entity fetch List pagination Search functionality React Query dependencies conditional fetching Single Entity Query Fileimport useServiceQuery/hooks/shared getEntityAction/actions{domain-actions useEntity(entityId string useServiceQuery{domain entityId getEntityAction fetch ID provided List Query File `hooks{domain-{entities Pagination parameters export useEntities ListParams useServiceQuery{domain listEntitiesAction(params Search Query Hook `Write File `hooks/{domain{entity-search Debouncing search input export useEntitySearch(searchQuery string debouncedQuery useServiceQuery{domain debouncedQuery searchEntitiesAction enabled debouncedQuery.length > 3

Hooks run dev Test component hooks Verify Data fetched Loading Error states Monitor React Query DevTools cache behavior Hooks standardized query key pattern Loading states DevTools cache behavior TypeScript types correct Tool Context7 Write Bash Task 2.2 Create Mutation Hooks TypeScript Pro 3 hours Critical Server actions 1) Hook templates (Week 3)-create React Query Mutation React Query useMutation updates cache invalidation Mutation File-create-import useServiceMutation/hooks/shared useQueryClient@tanstack/react-query createEntityAction from/app/actions/{domain-actions useCreateEntity() queryClient useServiceMutation Invalidate queries domain **Create Update Mutation Hook** Tool `Write File `hooks/{domain-update-{entity.ts Cache invalidation specific entity export useUpdateEntity() useServiceMutation updateEntityAction Invalidate entity.invalidateQueries Invalidate queryClient \*\*Create Delete Mutation Tool `Write File `hooks/{domain/use-delete-{entity.ts Include Optimistic update (optional export useDeleteEntity() useServiceMutation deleteEntityAction Remove from cache queryClientremoveQueries{domain 'detail entityId Invalidate list queryClient{domain 'list'

run dev component mutation hooks entity verify list updates Update Delete removal Monitor DevTools cache invalidation Mutations trigger cache Lists update Error states TypeScript types correct Tool Context7 Write Bash Wave 2 Completion Criteria tasks (3 hours Query hooks Mutation hooks Cache invalidation DevTools confirm behavior Wave hooks ready Wave UI Components (6 hours Sequential 2 hooks Task 3.1 Implement UI Components Full-Stack Developer 6 hours Critical Query hooks Mutation hooks Zustand stores-list Table search-form Create form-delete-dialog Confirmation-by-Step React Component MCP React/Nextcomponent practices form patterns validation table components List Component Magic table component table component {entity search filter sort `components{domain{entity-list Integrate useEntities hook Add Search input filters store List Add pagination sorting controls usePlayerStore filters loading skeleton empty state

Form Component Magic MCP form {entity} validation react-hook-form `components/{domain/{entity-form.tsx useCreateEntity hooks Add Form validation error display Form client-side validation error handling loading state submission success feedback Detail MCP detail view detail view {entity} edit delete actions `components/{domain/{entity-detail useEntity hook useUpdateEntity Delete Confirmation `components/{domain{entity-delete-dialogIntegrate useUIStore useDeleteEntity hook Confirmation message cancel buttons Add Tailwind CSS classes Consistent design system Responsive design UI dev List view displays Search filter Create Edit Delete confirmation Error states Loading Address bugs functionality works view entities create edit delete confirmation Search filter No console errors Responsive design Tool Context7 Magic Write Edit Bash Wave 3 Completion Criteria UI components functional CRUD operations Manual testing complete Ready E2E test automation Wave UI functional E2E Tests (4 hours

Sequential Wave 3 UI Task 4.1 Implement E2E Tests Full-Stack Developer 4 hours Critical UI components functional (Wave 3) `e2e-crud.spec.ts CRUD workflow tests-search Search functionality tests-Step Playwright Best MCP Playwright documentation test patterns page object model best practices E2E Test-crud.spec.ts Setup Test fixtures page objects Create Workflow Add test entity creation test new entity page Fill form Value Submit Verify expect.locator createdlocator=Test Value Read/View Workflow Add test viewing entity details Click entity detail view opens data displayed Update test entity update Open entity edit modify save Updated data list detail view Delete Workflow Add test entity deletion Open entity delete confirm entity removed list Search/Filter Tests-search.spec Search returns results Filters work E2E `Playwright MCP tests Monitor results pass/fail status Capture Screenshots failure `Playwright MCP failing tests Fix tests waits Fix selectors found

playwright test tests No flaky E2E tests CRUD workflow No flaky coverage >90% Tool Context7 Write Edit Playwright Bash Wave 4 Completion Criteria E2E tests feature validated Ready production

Feature Development 17 hours 20 3 hours (15%) Server actions (4h Query hooks Mutation UI components (6h E2E tests (4h Gates DB Service Action Hook UI CRUD operations E2E tests TypeScript compilation RLS policies <100ms execution

Phase 3 Investment 3 12 6 hours saved 4 17 hours 3 hours 5 17 3 6 17 3 63 hours hours saved (19% improvement Deliverables React Query Server action wrapper error mapping stores UI hook templates Integration tests ADR-003 Player Management Visit Tracking RatingSlip Creation Quality Metrics 100% TypeScript compilation >90% E2E test pass <100ms hook Zero security issues quality gates

Agent Utilization Matrix Week 3 Weeks 4-6 Total Hours-Stack React Query Tests UI Components Tests (12h Server Action Wrapper Actions (12h Hook Templates (3h Query Hooks Hooks ADR-003 Draft-003 Final (1h Agent 78 hours Calendar 63 hours 19%

MCP Tool Server Task Types 15 queries React components 3 analyses Error design decisions Result mapping 12 generations UI 3 features 3 test suites debugging 10+ queries Service testing data setup audit logging

Quality Gate Week 3 React Query Server action wrapper service Hook templates 7 services tests ADR-003 DevTools Per-Feature Gates 4-6 DB Service Action Hook UI CRUD operations UI E2E tests TypeScript compilation errors RLS policies Performance targets<100ms

Execution Week 3: 4 agents Wave 1 (4 TypeScript Pro 2 (3 Full-Stack Developer 3 (4 System Architect 4 (1 Weeks 4-6 Backend Architect 1 (4 2 TypeScript 2 (3 Full Developer 3 (6-Stack Developer 4 (4

Progress Tracking Daily Update TodoWrite task Run type-check layer Test functionality Weekly Update-2/SESSION_HANDOFF.md progress security advisor address issues Commit changes VERTICAL Review metrics adjust timeline End Phase 3 Update_PRODUCTION_ROADMAP Document lessons ADRs E2E test Create Phase 4

Reference Materials overview plan HORIZONTAL VERTICAL_RESPONSIBILITY State management strategy Week Progress tracking status updates Ready execution Launch Wave 1 Week 3 63 hours 4 weeks Development team 2025-10-10
